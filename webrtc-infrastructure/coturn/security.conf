# Coturn Security Configuration
# Additional security hardening for production deployments

# Authentication and authorization
no-auth
use-auth-secret
stale-nonce=600

# Disable less secure authentication methods
no-software-attribute

# Security restrictions
no-loopback-peers
no-multicast-peers
denied-peer-ip=0.0.0.0-0.255.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=::1

# Allow only private networks for relay
allowed-peer-ip=10.0.0.0-10.255.255.255
allowed-peer-ip=172.16.0.0-172.31.255.255
allowed-peer-ip=192.168.0.0-192.168.255.255

# Rate limiting and quotas
max-allocate-lifetime=3600
max-allocate-timeout=60
user-quota=50
total-quota=1000

# Connection limits per user
bps-capacity=0
stun-only

# TLS Security
no-tlsv1
no-tlsv1_1
cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384"
ec-curve-name=prime256v1

# Disable unnecessary features
no-cli
no-web-admin

# Logging security
log-file=stdout
syslog
no-stdout-log

# Process security
proc-user=coturn
proc-group=coturn

# Additional security flags
secure-stun
fingerprint
keep-address-family
mobility

# DTLS/TLS certificate rotation
cert-rotation-time=86400

# DoS protection
max-allocate-timeout=60
channel-lifetime=600
permission-lifetime=300

# WebRTC specific security
check-origin-consistency
origin=https://yourdomain.com

# Prometheus metrics with authentication
prometheus
prometheus-username=metrics
prometheus-password=secure-metrics-password